<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Distribución Poisson</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="poisson_files/libs/clipboard/clipboard.min.js"></script>
<script src="poisson_files/libs/quarto-html/quarto.js"></script>
<script src="poisson_files/libs/quarto-html/popper.min.js"></script>
<script src="poisson_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="poisson_files/libs/quarto-html/anchor.min.js"></script>
<link href="poisson_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="poisson_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="poisson_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="poisson_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="poisson_files/libs/bootstrap/bootstrap-1bc8a17f135ab3d594c857e9f48e611b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Distribución Poisson</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<style>
main.content {
text-align: justify}
</style>
<section id="introducción" class="level2">
<h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<p>La distribución de Poisson es una de las distribuciones de probabilidad discretas más importantes en estadística y tiene una amplia gama de aplicaciones en diversas disciplinas. Fue desarrollada por el matemático francés Siméon Denis Poisson en 1837 como una extensión del trabajo de Abraham de Moivre sobre la distribución binomial.</p>
<p>Esta distribución es especialmente útil para modelar el <strong>número de eventos que ocurren en un intervalo fijo</strong> de tiempo, espacio, volumen, o cualquier otra unidad de medida, cuando estos eventos:</p>
<ul>
<li>Ocurren de manera <strong>independiente</strong></li>
<li>Tienen una <strong>tasa promedio constante</strong></li>
<li>Es <strong>raro</strong> que ocurran múltiples eventos simultáneamente</li>
</ul>
<section id="aplicaciones-comunes" class="level3">
<h3 class="anchored" data-anchor-id="aplicaciones-comunes">Aplicaciones Comunes</h3>
<p>La distribución de Poisson se utiliza frecuentemente para modelar:</p>
<ul>
<li><strong>Llegadas de clientes</strong> a un banco o restaurante por hora</li>
<li><strong>Llamadas telefónicas</strong> recibidas en un centro de atención por minuto</li>
<li><strong>Defectos de fabricación</strong> en un lote de productos</li>
<li><strong>Accidentes de tráfico</strong> en una intersección por día</li>
<li><strong>Mutaciones genéticas</strong> en una secuencia de ADN</li>
<li><strong>Partículas radioactivas</strong> detectadas por un contador Geiger</li>
<li><strong>Terremotos</strong> en una región geográfica por año</li>
</ul>
<p>La distribución de Poisson también surge como <strong>aproximación a la distribución binomial</strong> cuando <span class="math inline">\(n\)</span> es grande y <span class="math inline">\(p\)</span> es pequeño, manteniendo <span class="math inline">\(np\)</span> constante.</p>
</section>
</section>
<section id="definición" class="level2">
<h2 class="anchored" data-anchor-id="definición">Definición</h2>
<div id="def-poisson" class="theorem definition">
<p><span class="theorem-title"><strong>Definición 1</strong></span> Una variable aleatoria <span class="math inline">\(X\)</span> sigue una <strong>distribución de Poisson</strong> con parámetro <span class="math inline">\(\lambda\)</span> si cuenta el número de eventos que ocurren en un intervalo fijo, donde <span class="math inline">\(\lambda\)</span> representa la tasa promedio de ocurrencia de eventos en ese intervalo. La función de masa de probabilidad de la distribución de Poisson está dada por:</p>
<p><span class="math display">\[f(x)= \frac{\lambda^x e^{-\lambda}}{x!}\]</span></p>
<p>donde:</p>
<ul>
<li><span class="math inline">\(x = 0, 1, 2, 3, \ldots\)</span> (número entero no negativo de eventos)</li>
<li><span class="math inline">\(\lambda &gt; 0\)</span> (parámetro de tasa)</li>
<li><span class="math inline">\(e \approx 2.71828\)</span> (base del logaritmo natural)</li>
</ul>
<p>A una variable aleatoria que sigue esta distribución se le denota como <span class="math inline">\(X \sim \text{Poisson}(\lambda)\)</span></p>
</div>
</section>
<section id="características" class="level2">
<h2 class="anchored" data-anchor-id="características">Características</h2>
<p><strong>Parámetros</strong></p>
<p>La distribución de Poisson tiene un único parámetro:</p>
<ul>
<li><p><span class="math inline">\(\lambda\)</span> (lambda): Tasa promedio de eventos por unidad de medida (<span class="math inline">\(\lambda &gt; 0\)</span>)</p>
<ul>
<li>También representa tanto la media como la varianza de la distribución</li>
<li>Es un número real positivo</li>
<li>Sus unidades dependen del contexto (eventos/hora, defectos/lote, etc.)</li>
</ul></li>
</ul>
<p><strong>Parámetros Estadísticos</strong></p>
<p>Una característica notable de la distribución de Poisson es que su <strong>media y varianza son iguales</strong>:</p>
<p>Media (Esperanza):</p>
<p><span class="math display">\[E(X) = \lambda\]</span></p>
<p>Varianza:</p>
<p><span class="math display">\[\text{Var}(X) = \lambda\]</span></p>
<p>Desviación estándar:</p>
<p><span class="math display">\[\sigma = \sqrt{\lambda}\]</span></p>
<p>Coeficiente de variación:</p>
<p><span class="math display">\[CV = \frac{\sigma}{\mu} = \frac{\sqrt{\lambda}}{\lambda} = \frac{1}{\sqrt{\lambda}}\]</span></p>
<p><strong>Función de Distribución (Probabilidad Acumulada)</strong></p>
<p>La función de distribución acumulada (CDF) es:</p>
<p><span class="math display">\[F(x) = P(X \leq x) = \sum_{i=0}^{x} \frac{\lambda^i e^{-\lambda}}{i!}\]</span></p>
<p>Esta suma no tiene una forma cerrada simple, por lo que generalmente se calcula numéricamente o se consulta en tablas estadísticas.</p>
</section>
<section id="ejemplo-básico" class="level2">
<h2 class="anchored" data-anchor-id="ejemplo-básico">Ejemplo Básico</h2>
<p>Un centro de atención telefónica recibe en promedio 4 llamadas por minuto. Suponiendo que las llamadas siguen un proceso de Poisson, responde las siguientes preguntas:</p>
<ol type="a">
<li>¿Cuál es la probabilidad de recibir exactamente 6 llamadas en un minuto?</li>
<li>¿Cuál es la probabilidad de no recibir ninguna llamada en un minuto?</li>
<li>¿Cuál es la probabilidad de recibir 3 o menos llamadas en un minuto?</li>
</ol>
<p><strong>Identificación del modelo:</strong></p>
<ul>
<li>Variable: <span class="math inline">\(X\)</span> = número de llamadas por minuto</li>
<li>Distribución: <span class="math inline">\(X \sim \text{Poisson}(\lambda = 4)\)</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parámetro</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># a) P(X = 6)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>prob_6 <span class="ot">&lt;-</span> <span class="fu">dpois</span>(<span class="dv">6</span>, lambda)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"a) P(X = 6) ="</span>, <span class="fu">round</span>(prob_6, <span class="dv">4</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>a) P(X = 6) = 0.1042</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificación manual</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>prob_6_manual <span class="ot">&lt;-</span> (lambda<span class="sc">^</span><span class="dv">6</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda)) <span class="sc">/</span> <span class="fu">factorial</span>(<span class="dv">6</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">   Verificación manual:"</span>, <span class="fu">round</span>(prob_6_manual, <span class="dv">4</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   Verificación manual: 0.1042</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># b) P(X = 0)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>prob_0 <span class="ot">&lt;-</span> <span class="fu">dpois</span>(<span class="dv">0</span>, lambda)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">b) P(X = 0) ="</span>, <span class="fu">round</span>(prob_0, <span class="dv">4</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

b) P(X = 0) = 0.0183</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># c) P(X ≤ 3)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>prob_3_o_menos <span class="ot">&lt;-</span> <span class="fu">ppois</span>(<span class="dv">3</span>, lambda)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">c) P(X ≤ 3) ="</span>, <span class="fu">round</span>(prob_3_o_menos, <span class="dv">4</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

c) P(X ≤ 3) = 0.4335</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificación manual para c)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>prob_3_manual <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">dpois</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, lambda))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">   Verificación manual:"</span>, <span class="fu">round</span>(prob_3_manual, <span class="dv">4</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   Verificación manual: 0.4335</code></pre>
</div>
</div>
<p><strong>Interpretación de Resultados</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"a) La probabilidad de recibir exactamente 6 llamadas en un minuto es"</span>, </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(prob_6, <span class="dv">6</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>a) La probabilidad de recibir exactamente 6 llamadas en un minuto es 0.104196 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"b) La probabilidad de no recibir ninguna llamada en un minuto es"</span>, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(prob_0 , <span class="dv">6</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>b) La probabilidad de no recibir ninguna llamada en un minuto es 0.018316 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"c) La probabilidad de recibir 3 o menos llamadas en un minuto es"</span>, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(prob_3_o_menos, <span class="dv">6</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>c) La probabilidad de recibir 3 o menos llamadas en un minuto es 0.43347 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estadísticas adicionales</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>media <span class="ot">&lt;-</span> lambda</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>varianza <span class="ot">&lt;-</span> lambda</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>desv_std <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(lambda)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Estadísticas de la distribución:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estadísticas de la distribución:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Media:"</span>, media, <span class="st">"llamadas por minuto</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Media: 4 llamadas por minuto</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Varianza:"</span>, varianza, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Varianza: 4 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Desviación estándar:"</span>, <span class="fu">round</span>(desv_std, <span class="dv">2</span>), <span class="st">"llamadas por minuto</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Desviación estándar: 2 llamadas por minuto</code></pre>
</div>
</div>
<p><strong>Gráfica de la Distribución del Ejemplo</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Valores para graficar</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>k_vals <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>prob_vals <span class="ot">&lt;-</span> <span class="fu">dpois</span>(k_vals, lambda)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Data frame para ggplot</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>data_ejemplo <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> k_vals, <span class="at">probabilidad =</span> prob_vals)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Resaltar los valores del ejemplo</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>data_ejemplo<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"Normal"</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>data_ejemplo<span class="sc">$</span>color[data_ejemplo<span class="sc">$</span>k <span class="sc">==</span> <span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="st">"P(X = 6)"</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>data_ejemplo<span class="sc">$</span>color[data_ejemplo<span class="sc">$</span>k <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="st">"P(X = 0)"</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>data_ejemplo<span class="sc">$</span>color[data_ejemplo<span class="sc">$</span>k <span class="sc">&lt;=</span> <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data_ejemplo<span class="sc">$</span>color[data_ejemplo<span class="sc">$</span>k <span class="sc">&lt;=</span> <span class="dv">3</span>] <span class="sc">==</span> <span class="st">"Normal"</span>, </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>                                                 <span class="st">"P(X ≤ 3)"</span>, data_ejemplo<span class="sc">$</span>color[data_ejemplo<span class="sc">$</span>k <span class="sc">&lt;=</span> <span class="dv">3</span>])</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_ejemplo, <span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> probabilidad, <span class="at">fill =</span> color)) <span class="sc">+</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución de Poisson: Llamadas Telefónicas"</span>,</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"λ = 4 llamadas por minuto"</span>,</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Número de llamadas (k)"</span>,</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Probabilidad P(X = k)"</span>,</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Casos del ejemplo"</span>) <span class="sc">+</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Normal"</span> <span class="ot">=</span> <span class="st">"#BDC3C7"</span>, </span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"P(X = 6)"</span> <span class="ot">=</span> <span class="st">"#E74C3C"</span>, </span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"P(X = 0)"</span> <span class="ot">=</span> <span class="st">"#3498DB"</span>,</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"P(X ≤ 3)"</span> <span class="ot">=</span> <span class="st">"#2ECC71"</span>)) <span class="sc">+</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> k_vals) <span class="sc">+</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="poisson_files/figure-html/grafico-ejemplo-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Distribución de Poisson para el ejemplo (λ = 4)</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="comparación-efecto-del-parámetro-lambda" class="level2">
<h2 class="anchored" data-anchor-id="comparación-efecto-del-parámetro-lambda">Comparación: Efecto del Parámetro <span class="math inline">\(\lambda\)</span></h2>
<p>El parámetro <span class="math inline">\(\lambda\)</span> controla tanto la <strong>posición central</strong> como la <strong>dispersión</strong> de la distribución de Poisson.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diferentes valores de lambda</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>lambda_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rango de k para cada lambda</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>k_max <span class="ot">&lt;-</span> <span class="fu">max</span>(lambda_values) <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fu">max</span>(lambda_values))</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>k_vals <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="fu">ceiling</span>(k_max)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear data frame para todos los valores</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>data_lambda <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">k =</span> k_vals, <span class="at">lambda =</span> lambda_values)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>data_lambda<span class="sc">$</span>probabilidad <span class="ot">&lt;-</span> <span class="fu">dpois</span>(data_lambda<span class="sc">$</span>k, data_lambda<span class="sc">$</span>lambda)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>data_lambda<span class="sc">$</span>lambda_label <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"λ ="</span>, data_lambda<span class="sc">$</span>lambda)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>data_lambda<span class="sc">$</span>lambda_label <span class="ot">&lt;-</span> <span class="fu">factor</span>(data_lambda<span class="sc">$</span>lambda_label, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"λ = 1"</span>, <span class="st">"λ = 3"</span>, <span class="st">"λ = 5"</span>, <span class="st">"λ = 10"</span>))</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico comparativo</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_lambda, <span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> probabilidad, <span class="at">fill =</span> lambda_label)) <span class="sc">+</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">position =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>lambda_label, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Efecto del Parámetro λ en la Distribución de Poisson"</span>,</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"A mayor λ, la distribución se desplaza hacia la derecha y se dispersa más"</span>,</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Número de eventos (k)"</span>,</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Probabilidad P(X = k)"</span>) <span class="sc">+</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">type =</span> <span class="st">"qual"</span>, <span class="at">palette =</span> <span class="st">"Set1"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="poisson_files/figure-html/efecto-lambda-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Efecto del parámetro λ en la distribución de Poisson</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Comparación Superpuesta</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Limitar k para mejor visualización</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>k_vals_plot <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar datos</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>data_plot <span class="ot">&lt;-</span> data_lambda[data_lambda<span class="sc">$</span>k <span class="sc">&lt;=</span> <span class="dv">20</span>, ]</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico superpuesto</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_plot, <span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> probabilidad, <span class="at">color =</span> lambda_label)) <span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparación de Distribuciones de Poisson"</span>,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Diferentes valores del parámetro λ"</span>,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Número de eventos (k)"</span>,</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Probabilidad P(X = k)"</span>,</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Parámetro λ"</span>) <span class="sc">+</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">type =</span> <span class="st">"qual"</span>, <span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="poisson_files/figure-html/comparacion-superpuesta-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Comparación superpuesta de diferentes valores de λ</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Tabla Comparativa de Parámetros Estadísticos</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear tabla con estadísticas para diferentes lambdas</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>lambdas_tabla <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">15</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>tabla_stats <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lambda =</span> lambdas_tabla,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Media =</span> lambdas_tabla,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Varianza =</span> lambdas_tabla,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Desv_Std =</span> <span class="fu">sqrt</span>(lambdas_tabla),</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">CV =</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(lambdas_tabla),</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">P_X_eq_0 =</span> <span class="fu">dpois</span>(<span class="dv">0</span>, lambdas_tabla)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tabla_stats, <span class="at">digits =</span> <span class="dv">4</span>,</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Parámetros estadísticos para diferentes valores de λ"</span>,</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"λ"</span>, <span class="st">"Media"</span>, <span class="st">"Varianza"</span>, <span class="st">"Desv. Std."</span>, <span class="st">"CV"</span>, <span class="st">"P(X=0)"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Parámetros estadísticos para diferentes valores de λ</caption>
<thead>
<tr class="header">
<th style="text-align: right;">λ</th>
<th style="text-align: right;">Media</th>
<th style="text-align: right;">Varianza</th>
<th style="text-align: right;">Desv. Std.</th>
<th style="text-align: right;">CV</th>
<th style="text-align: right;">P(X=0)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.7071</td>
<td style="text-align: right;">1.4142</td>
<td style="text-align: right;">0.6065</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1.0000</td>
<td style="text-align: right;">1.0000</td>
<td style="text-align: right;">0.3679</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">1.4142</td>
<td style="text-align: right;">0.7071</td>
<td style="text-align: right;">0.1353</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.7321</td>
<td style="text-align: right;">0.5774</td>
<td style="text-align: right;">0.0498</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">2.2361</td>
<td style="text-align: right;">0.4472</td>
<td style="text-align: right;">0.0067</td>
</tr>
<tr class="even">
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">2.8284</td>
<td style="text-align: right;">0.3536</td>
<td style="text-align: right;">0.0003</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10.0</td>
<td style="text-align: right;">10.0</td>
<td style="text-align: right;">10.0</td>
<td style="text-align: right;">3.1623</td>
<td style="text-align: right;">0.3162</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: right;">15.0</td>
<td style="text-align: right;">15.0</td>
<td style="text-align: right;">15.0</td>
<td style="text-align: right;">3.8730</td>
<td style="text-align: right;">0.2582</td>
<td style="text-align: right;">0.0000</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="simulación-de-valores-poisson-y-comparación-con-la-teórica" class="level2">
<h2 class="anchored" data-anchor-id="simulación-de-valores-poisson-y-comparación-con-la-teórica">Simulación de Valores Poisson y Comparación con la Teórica</h2>
<p>Consideremos una simulación con <span class="math inline">\(\lambda = 3.5\)</span> y <span class="math inline">\(n = 15,000\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parámetros para la simulación</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fl">3.5</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="dv">15000</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulación de valores</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>valores_simulados <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n_sim, lambda)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Estadísticas de la simulación</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>media_sim <span class="ot">&lt;-</span> <span class="fu">mean</span>(valores_simulados)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>var_sim <span class="ot">&lt;-</span> <span class="fu">var</span>(valores_simulados)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>sd_sim <span class="ot">&lt;-</span> <span class="fu">sd</span>(valores_simulados)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Valores teóricos</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>media_teorica <span class="ot">&lt;-</span> lambda</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>var_teorica <span class="ot">&lt;-</span> lambda</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>sd_teorica <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(lambda)</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla comparativa</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>comparacion <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  Estadística <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Media"</span>, <span class="st">"Varianza"</span>, <span class="st">"Desv. Estándar"</span>),</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  Teórica <span class="ot">=</span> <span class="fu">c</span>(media_teorica, var_teorica, sd_teorica),</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Simulada =</span> <span class="fu">c</span>(media_sim, var_sim, sd_sim),</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">Diferencia =</span> <span class="fu">c</span>(<span class="fu">abs</span>(media_teorica <span class="sc">-</span> media_sim), </span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">abs</span>(var_teorica <span class="sc">-</span> var_sim), </span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">abs</span>(sd_teorica <span class="sc">-</span> sd_sim)),</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">Error_Relativo =</span> <span class="fu">c</span>(<span class="fu">abs</span>(media_teorica <span class="sc">-</span> media_sim)<span class="sc">/</span>media_teorica <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">abs</span>(var_teorica <span class="sc">-</span> var_sim)<span class="sc">/</span>var_teorica <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">abs</span>(sd_teorica <span class="sc">-</span> sd_sim)<span class="sc">/</span>sd_teorica <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(comparacion, <span class="at">digits =</span> <span class="dv">4</span>, </span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">"Comparación teórica vs simulada (λ ="</span>, lambda, <span class="st">", n ="</span>, <span class="fu">format</span>(n_sim, <span class="at">big.mark =</span> <span class="st">","</span>)),</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Estadística"</span>, <span class="st">"Teórica"</span>, <span class="st">"Simulada"</span>, <span class="st">"Diferencia"</span>, <span class="st">"Error Rel. (%)"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Comparación teórica vs simulada (λ = 3.5 , n = 15,000</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Estadística</th>
<th style="text-align: right;">Teórica</th>
<th style="text-align: right;">Simulada</th>
<th style="text-align: right;">Diferencia</th>
<th style="text-align: right;">Error Rel. (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Media</td>
<td style="text-align: right;">3.5000</td>
<td style="text-align: right;">3.4960</td>
<td style="text-align: right;">0.0040</td>
<td style="text-align: right;">0.1143</td>
</tr>
<tr class="even">
<td style="text-align: left;">Varianza</td>
<td style="text-align: right;">3.5000</td>
<td style="text-align: right;">3.5328</td>
<td style="text-align: right;">0.0328</td>
<td style="text-align: right;">0.9358</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Desv. Estándar</td>
<td style="text-align: right;">1.8708</td>
<td style="text-align: right;">1.8796</td>
<td style="text-align: right;">0.0087</td>
<td style="text-align: right;">0.4668</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Comparación Gráfica: Simulación vs Teórica</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rango de valores para comparar</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>k_max <span class="ot">&lt;-</span> <span class="fu">quantile</span>(valores_simulados, <span class="fl">0.99</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>k_vals <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>k_max</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidades teóricas</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>prob_teorica <span class="ot">&lt;-</span> <span class="fu">dpois</span>(k_vals, lambda)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Frecuencias relativas de la simulación</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>freq_tabla <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">factor</span>(valores_simulados, <span class="at">levels =</span> k_vals))</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>freq_relativa <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(freq_tabla) <span class="sc">/</span> n_sim</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear data frame para ggplot</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>data_comp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="fu">rep</span>(k_vals, <span class="dv">2</span>),</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Probabilidad =</span> <span class="fu">c</span>(prob_teorica, freq_relativa),</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tipo =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Teórica"</span>, <span class="st">"Simulada"</span>), <span class="at">each =</span> <span class="fu">length</span>(k_vals))</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de barras comparativo</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_comp, <span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Probabilidad, <span class="at">fill =</span> Tipo)) <span class="sc">+</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">width =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, k_max, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución de Poisson: Teórica vs Simulada"</span>,</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"λ ="</span>, lambda, <span class="st">", n ="</span>, <span class="fu">format</span>(n_sim, <span class="at">big.mark =</span> <span class="st">","</span>)),</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Número de eventos (k)"</span>,</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Probabilidad / Frecuencia relativa"</span>,</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Distribución"</span>) <span class="sc">+</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Teórica"</span> <span class="ot">=</span> <span class="st">"#3498DB"</span>, <span class="st">"Simulada"</span> <span class="ot">=</span> <span class="st">"#E74C3C"</span>)) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="poisson_files/figure-html/grafico-comparacion-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Comparación entre distribución teórica y simulada de Poisson</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="verificación-de-la-suma-de-variables-poisson-independientes" class="level2">
<h2 class="anchored" data-anchor-id="verificación-de-la-suma-de-variables-poisson-independientes">Verificación de la Suma de Variables Poisson Independientes</h2>
<div id="thm-suma-poisson" class="theorem">
<p><span class="theorem-title"><strong>Teorema 1</strong></span> Si <span class="math inline">\(X_1 \sim \text{Poisson}(\lambda_1)\)</span> y <span class="math inline">\(X_2 \sim \text{Poisson}(\lambda_2)\)</span> son independientes, entonces:</p>
<p><span class="math display">\[Y = X_1 + X_2 \sim \text{Poisson}(\lambda_1 + \lambda_2)\]</span></p>
<p><strong>Generalización:</strong> Si <span class="math inline">\(X_1, X_2, \ldots, X_n\)</span> son variables Poisson independientes con parámetros <span class="math inline">\(\lambda_1, \lambda_2, \ldots, \lambda_n\)</span>, entonces:</p>
<p><span class="math display">\[\sum_{i=1}^n X_i \sim \text{Poisson}\left(\sum_{i=1}^n \lambda_i\right)\]</span></p>
</div>
<section id="verificación-por-simulación-caso-de-dos-variables" class="level3">
<h3 class="anchored" data-anchor-id="verificación-por-simulación-caso-de-dos-variables">Verificación por Simulación: Caso de Dos Variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parámetros para las dos variables Poisson</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>lambda1 <span class="ot">&lt;-</span> <span class="fl">2.5</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>lambda2 <span class="ot">&lt;-</span> <span class="fl">4.2</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>lambda_suma <span class="ot">&lt;-</span> lambda1 <span class="sc">+</span> lambda2</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>n_sim_suma <span class="ot">&lt;-</span> <span class="dv">12000</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 1: Generar dos Poisson independientes y sumarlas</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n_sim_suma, lambda1)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n_sim_suma, lambda2)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>suma_simulada <span class="ot">&lt;-</span> X1 <span class="sc">+</span> X2</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 2: Generar directamente de Poisson(λ₁ + λ₂)</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>poisson_directa <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n_sim_suma, lambda_suma)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparar estadísticas</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>stats_suma <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  Método <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"X₁ + X₂ (Suma)"</span>, <span class="st">"Poisson Directa"</span>, <span class="st">"Teórico"</span>),</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Media =</span> <span class="fu">c</span>(<span class="fu">mean</span>(suma_simulada), <span class="fu">mean</span>(poisson_directa), lambda_suma),</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">Varianza =</span> <span class="fu">c</span>(<span class="fu">var</span>(suma_simulada), <span class="fu">var</span>(poisson_directa), lambda_suma),</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">Desv_Std =</span> <span class="fu">c</span>(<span class="fu">sd</span>(suma_simulada), <span class="fu">sd</span>(poisson_directa), <span class="fu">sqrt</span>(lambda_suma)),</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Min =</span> <span class="fu">c</span>(<span class="fu">min</span>(suma_simulada), <span class="fu">min</span>(poisson_directa), <span class="dv">0</span>),</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">Max =</span> <span class="fu">c</span>(<span class="fu">max</span>(suma_simulada), <span class="fu">max</span>(poisson_directa), <span class="cn">NA</span>)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(stats_suma, <span class="at">digits =</span> <span class="dv">4</span>,</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">"Verificación suma de Poisson (λ₁ ="</span>, lambda1, <span class="st">", λ₂ ="</span>, lambda2, <span class="st">")"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Verificación suma de Poisson (λ₁ = 2.5 , λ₂ = 4.2 )</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Método</th>
<th style="text-align: right;">Media</th>
<th style="text-align: right;">Varianza</th>
<th style="text-align: right;">Desv_Std</th>
<th style="text-align: right;">Min</th>
<th style="text-align: right;">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">X₁ + X₂ (Suma)</td>
<td style="text-align: right;">6.6752</td>
<td style="text-align: right;">6.6432</td>
<td style="text-align: right;">2.5774</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="even">
<td style="text-align: left;">Poisson Directa</td>
<td style="text-align: right;">6.6546</td>
<td style="text-align: right;">6.7097</td>
<td style="text-align: right;">2.5903</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Teórico</td>
<td style="text-align: right;">6.7000</td>
<td style="text-align: right;">6.7000</td>
<td style="text-align: right;">2.5884</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Información adicional</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">PARÁMETROS INDIVIDUALES:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
PARÁMETROS INDIVIDUALES:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"========================</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>========================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"X₁ ~ Poisson("</span>, lambda1, <span class="st">"): E(X₁) ="</span>, lambda1, <span class="st">", Var(X₁) ="</span>, lambda1, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X₁ ~ Poisson( 2.5 ): E(X₁) = 2.5 , Var(X₁) = 2.5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"X₂ ~ Poisson("</span>, lambda2, <span class="st">"): E(X₂) ="</span>, lambda2, <span class="st">", Var(X₂) ="</span>, lambda2, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X₂ ~ Poisson( 4.2 ): E(X₂) = 4.2 , Var(X₂) = 4.2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SUMA TEÓRICA:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SUMA TEÓRICA:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=============</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=============</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Y = X₁ + X₂ ~ Poisson("</span>, lambda_suma, <span class="st">")</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Y = X₁ + X₂ ~ Poisson( 6.7 )</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"E[Y] = E(X₁) + E(X₂) ="</span>, lambda_suma, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>E[Y] = E(X₁) + E(X₂) = 6.7 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Var(Y) = Var(X₁) + Var(X₂) ="</span>, lambda_suma, <span class="st">" (por independencia)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Var(Y) = Var(X₁) + Var(X₂) = 6.7  (por independencia)</code></pre>
</div>
</div>
<p><strong>Comparación Visual de las Distribuciones</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear data frame para comparación</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>data_suma_comp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">valores =</span> <span class="fu">c</span>(suma_simulada, poisson_directa),</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">metodo =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"X1 + X2"</span>, <span class="st">"Poisson(λ1+λ2)"</span>), <span class="at">each =</span> n_sim_suma)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogramas superpuestos</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_suma_comp, <span class="fu">aes</span>(<span class="at">x =</span> valores, <span class="at">fill =</span> metodo)) <span class="sc">+</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="st">"dodge2"</span>, <span class="at">center =</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(<span class="fu">c</span>(suma_simulada, poisson_directa)), <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Verificación de la Propiedad Aditiva de Poisson"</span>,</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"λ1 ="</span>, lambda1, <span class="st">", λ2 ="</span>, lambda2, <span class="st">", λ1+λ2 ="</span>, lambda_suma),</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Número de eventos"</span>,</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frecuencia"</span>,</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Método"</span>) <span class="sc">+</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"X1 + X2"</span> <span class="ot">=</span> <span class="st">"#3498DB"</span>, <span class="st">"Poisson(λ1+λ2)"</span> <span class="ot">=</span> <span class="st">"#E74C3C"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="poisson_files/figure-html/comparacion-visual-suma-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Comparación visual: Suma de Poisson vs Poisson directa</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="verificación-con-múltiples-variables" class="level3">
<h3 class="anchored" data-anchor-id="verificación-con-múltiples-variables">Verificación con Múltiples Variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Suma de 4 variables Poisson independientes</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>lambdas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">2.0</span>, <span class="fl">2.5</span>, <span class="fl">3.0</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>lambda_total <span class="ot">&lt;-</span> <span class="fu">sum</span>(lambdas)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>n_vars <span class="ot">&lt;-</span> <span class="fu">length</span>(lambdas)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Generar las variables individuales</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>variables_poisson <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> n_sim_suma, <span class="at">ncol =</span> n_vars)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_vars) {</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  variables_poisson[, i] <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n_sim_suma, lambdas[i])</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Suma de las 4 variables</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>suma_multiple <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(variables_poisson)</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Poisson directa con λ total</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>poisson_multiple_directa <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n_sim_suma, lambda_total)</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Estadísticas comparativas</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"VERIFICACIÓN CON"</span>, n_vars, <span class="st">"VARIABLES POISSON</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>VERIFICACIÓN CON 4 VARIABLES POISSON</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"λ₁ ="</span>, lambdas[<span class="dv">1</span>], <span class="st">", λ₂ ="</span>, lambdas[<span class="dv">2</span>], <span class="st">", λ₃ ="</span>, lambdas[<span class="dv">3</span>], <span class="st">", λ₄ ="</span>, lambdas[<span class="dv">4</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>λ₁ = 1.5 , λ₂ = 2 , λ₃ = 2.5 , λ₄ = 3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"λ_total ="</span>, lambda_total, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>λ_total = 9 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>stats_multiple <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  Distribución <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Suma de 4 Poisson"</span>, <span class="st">"Poisson(λ_total)"</span>, <span class="st">"Diferencia"</span>),</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Media =</span> <span class="fu">c</span>(<span class="fu">mean</span>(suma_multiple), <span class="fu">mean</span>(poisson_multiple_directa), </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">abs</span>(<span class="fu">mean</span>(suma_multiple) <span class="sc">-</span> <span class="fu">mean</span>(poisson_multiple_directa))),</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Varianza =</span> <span class="fu">c</span>(<span class="fu">var</span>(suma_multiple), <span class="fu">var</span>(poisson_multiple_directa),</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">abs</span>(<span class="fu">var</span>(suma_multiple) <span class="sc">-</span> <span class="fu">var</span>(poisson_multiple_directa)))</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(stats_multiple, <span class="at">digits =</span> <span class="dv">4</span>, </span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Estadísticas para suma de múltiples variables Poisson"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Estadísticas para suma de múltiples variables Poisson</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Distribución</th>
<th style="text-align: right;">Media</th>
<th style="text-align: right;">Varianza</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Suma de 4 Poisson</td>
<td style="text-align: right;">8.9958</td>
<td style="text-align: right;">9.0190</td>
</tr>
<tr class="even">
<td style="text-align: left;">Poisson(λ_total)</td>
<td style="text-align: right;">9.0409</td>
<td style="text-align: right;">8.8526</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Diferencia</td>
<td style="text-align: right;">0.0452</td>
<td style="text-align: right;">0.1663</td>
</tr>
</tbody>
</table>
<p>Verificación con suma de múltiples variables Poisson</p>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualización</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>data_multiple <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">valores =</span> <span class="fu">c</span>(suma_multiple, poisson_multiple_directa),</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">tipo =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Suma de 4 Poisson"</span>, <span class="st">"Poisson(λ_total)"</span>), <span class="at">each =</span> n_sim_suma)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_multiple, <span class="fu">aes</span>(<span class="at">x =</span> valores, <span class="at">fill =</span> tipo)) <span class="sc">+</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">center=</span><span class="dv">0</span>, <span class="at">position =</span> <span class="st">"dodge2"</span>) <span class="sc">+</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(<span class="fu">c</span>(suma_multiple, poisson_multiple_directa)), <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Suma de Múltiples Variables Poisson"</span>,</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"λ_total ="</span>, lambda_total),</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Número de eventos"</span>,</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frecuencia"</span>,</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Tipo"</span>) <span class="sc">+</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#2ECC71"</span>, <span class="st">"#F39C12"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="poisson_files/figure-html/suma-multiples-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Verificación con suma de múltiples variables Poisson</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="teorema-central-del-límite-con-variables-poisson" class="level2">
<h2 class="anchored" data-anchor-id="teorema-central-del-límite-con-variables-poisson">Teorema Central del Límite con Variables Poisson</h2>
<p><strong>Configuración del Experimento</strong></p>
<p>Consideremos una variable aleatoria <span class="math inline">\(X \sim \text{Poisson}(\lambda = 3)\)</span>. Vamos a generar múltiples muestras de diferentes tamaños y observar cómo se comporta la distribución de la media muestral <span class="math inline">\(\bar{X}\)</span>.</p>
<p><strong>Teoría esperada:</strong></p>
<ul>
<li>Para muestras de tamaño <span class="math inline">\(n\)</span> de <span class="math inline">\(X \sim \text{Poisson}(\lambda)\)</span></li>
<li><span class="math inline">\(\bar{X} \sim N\left(\lambda, \frac{\lambda}{n}\right)\)</span> cuando <span class="math inline">\(n\)</span> es grande</li>
<li><span class="math inline">\(E(\bar{X}) = \lambda\)</span> y <span class="math inline">\(\text{Var}(\bar{X}) = \frac{\lambda}{n}\)</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parámetros del experimento</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>lambda_tcl <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>tamaños_muestra <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>num_muestras <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CONFIGURACIÓN DEL EXPERIMENTO</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CONFIGURACIÓN DEL EXPERIMENTO</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=============================</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=============================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Distribución original: Poisson(λ ="</span>, lambda_tcl, <span class="st">")</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Distribución original: Poisson(λ = 3 )</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Tamaños de muestra:"</span>, <span class="fu">paste</span>(tamaños_muestra, <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tamaños de muestra: 5, 10, 25, 50, 100 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Número de muestras por tamaño:"</span>, num_muestras, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Número de muestras por tamaño: 2000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Parámetros teóricos de la distribución original:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parámetros teóricos de la distribución original:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"E[X] ="</span>, lambda_tcl, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>E[X] = 3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Var(X) ="</span>, lambda_tcl, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Var(X) = 3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SD(X) ="</span>, <span class="fu">round</span>(<span class="fu">sqrt</span>(lambda_tcl), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SD(X) = 1.732 </code></pre>
</div>
</div>
<p><strong>Generación de Muestras y Cálculo de Medias</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Función para generar medias muestrales</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>generar_medias_muestrales <span class="ot">&lt;-</span> <span class="cf">function</span>(n, num_muestras, lambda) {</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  medias <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_muestras)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_muestras) {</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>    muestra <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, lambda)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>    medias[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(muestra)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(medias)</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Generar medias para cada tamaño de muestra</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>medias_muestrales <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(tamaños_muestra)) {</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> tamaños_muestra[i]</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>  medias_muestrales[[i]] <span class="ot">&lt;-</span> <span class="fu">generar_medias_muestrales</span>(n, num_muestras, lambda_tcl)</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(medias_muestrales)[i] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"n"</span>, n, <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear data frame para análisis</span></span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>data_tcl <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(<span class="fu">seq_along</span>(medias_muestrales), <span class="cf">function</span>(i) {</span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">media_muestral =</span> medias_muestrales[[i]],</span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> tamaños_muestra[i],</span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_label =</span> <span class="fu">paste</span>(<span class="st">"n ="</span>, tamaños_muestra[i])</span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true" tabindex="-1"></a>data_tcl<span class="sc">$</span>n_label <span class="ot">&lt;-</span> <span class="fu">factor</span>(data_tcl<span class="sc">$</span>n_label, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"n = 5"</span>, <span class="st">"n = 10"</span>, <span class="st">"n = 25"</span>, <span class="st">"n = 50"</span>, <span class="st">"n = 100"</span>))</span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Muestras generadas exitosamente.</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Muestras generadas exitosamente.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total de observaciones:"</span>, <span class="fu">nrow</span>(data_tcl), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total de observaciones: 10000 </code></pre>
</div>
</div>
<p><strong>Verificación de Convergencia de Media y Varianza</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular estadísticas para cada tamaño de muestra</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>estadisticas_tcl <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> tamaños_muestra,</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Media_Observada =</span> <span class="fu">sapply</span>(medias_muestrales, mean),</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Media_Teorica =</span> <span class="fu">rep</span>(lambda_tcl, <span class="fu">length</span>(tamaños_muestra)),</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Var_Observada =</span> <span class="fu">sapply</span>(medias_muestrales, var),</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Var_Teorica =</span> lambda_tcl <span class="sc">/</span> tamaños_muestra,</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">SD_Observada =</span> <span class="fu">sapply</span>(medias_muestrales, sd),</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">SD_Teorica =</span> <span class="fu">sqrt</span>(lambda_tcl <span class="sc">/</span> tamaños_muestra)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular errores</span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>estadisticas_tcl <span class="ot">&lt;-</span> estadisticas_tcl <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Error_Media =</span> <span class="fu">abs</span>(Media_Observada <span class="sc">-</span> Media_Teorica),</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Error_Var =</span> <span class="fu">abs</span>(Var_Observada <span class="sc">-</span> Var_Teorica),</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Error_SD =</span> <span class="fu">abs</span>(SD_Observada <span class="sc">-</span> SD_Teorica))</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(estadisticas_tcl, <span class="at">digits =</span> <span class="dv">4</span>,</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Convergencia de estadísticos de la media muestral"</span>,</span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"n"</span>, <span class="st">"Media Obs."</span>, <span class="st">"Media Teór."</span>, <span class="st">"Var. Obs."</span>, <span class="st">"Var. Teór."</span>, </span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"SD Obs."</span>, <span class="st">"SD Teór."</span>, <span class="st">"Error Media"</span>, <span class="st">"Error Var."</span>, <span class="st">"Error SD"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Convergencia de estadísticos de la media muestral</caption>
<colgroup>
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">Media Obs.</th>
<th style="text-align: right;">Media Teór.</th>
<th style="text-align: right;">Var. Obs.</th>
<th style="text-align: right;">Var. Teór.</th>
<th style="text-align: right;">SD Obs.</th>
<th style="text-align: right;">SD Teór.</th>
<th style="text-align: right;">Error Media</th>
<th style="text-align: right;">Error Var.</th>
<th style="text-align: right;">Error SD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">n_5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2.9814</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.5870</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">0.7662</td>
<td style="text-align: right;">0.7746</td>
<td style="text-align: right;">0.0186</td>
<td style="text-align: right;">0.0130</td>
<td style="text-align: right;">0.0084</td>
</tr>
<tr class="even">
<td style="text-align: left;">n_10</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2.9926</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.3136</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.5600</td>
<td style="text-align: right;">0.5477</td>
<td style="text-align: right;">0.0074</td>
<td style="text-align: right;">0.0136</td>
<td style="text-align: right;">0.0123</td>
</tr>
<tr class="odd">
<td style="text-align: left;">n_25</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">2.9945</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.1171</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.3422</td>
<td style="text-align: right;">0.3464</td>
<td style="text-align: right;">0.0055</td>
<td style="text-align: right;">0.0029</td>
<td style="text-align: right;">0.0042</td>
</tr>
<tr class="even">
<td style="text-align: left;">n_50</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">3.0065</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.0579</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.2406</td>
<td style="text-align: right;">0.2449</td>
<td style="text-align: right;">0.0065</td>
<td style="text-align: right;">0.0021</td>
<td style="text-align: right;">0.0043</td>
</tr>
<tr class="odd">
<td style="text-align: left;">n_100</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">3.0000</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.0288</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.1698</td>
<td style="text-align: right;">0.1732</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0012</td>
<td style="text-align: right;">0.0035</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Visualización de la Convergencia</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogramas de las medias muestrales</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_tcl, <span class="fu">aes</span>(<span class="at">x =</span> media_muestral)) <span class="sc">+</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">fill =</span> <span class="st">"#3498DB"</span>) <span class="sc">+</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> lambda_tcl, <span class="at">color =</span> <span class="st">"#E74C3C"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>n_label, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución de Medias Muestrales (TCL)"</span>,</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Distribución original: Poisson(λ ="</span>, lambda_tcl, <span class="st">"). Línea roja: media teórica"</span>),</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Media muestral"</span>,</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Densidad"</span>) <span class="sc">+</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="poisson_files/figure-html/visualizacion-convergencia-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Distribución de medias muestrales para diferentes tamaños de muestra</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Agregar curvas normales específicas para cada panel</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>data_tcl_split <span class="ot">&lt;-</span> <span class="fu">split</span>(data_tcl, data_tcl<span class="sc">$</span>n_label)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>plots_comparacion <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">names</span>(data_tcl_split), <span class="cf">function</span>(label) {</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  datos <span class="ot">&lt;-</span> data_tcl_split[[label]]</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  n_val <span class="ot">&lt;-</span> <span class="fu">unique</span>(datos<span class="sc">$</span>n)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x =</span> media_muestral)) <span class="sc">+</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">bins =</span> <span class="dv">25</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">fill =</span> <span class="st">"#3498DB"</span>) <span class="sc">+</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, </span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> lambda_tcl, <span class="at">sd =</span> <span class="fu">sqrt</span>(lambda_tcl<span class="sc">/</span>n_val)), </span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> <span class="st">"#E74C3C"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(label) <span class="sc">+</span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Media muestral"</span>) <span class="sc">+</span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Densidad"</span>) <span class="sc">+</span></span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar gráficos</span></span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a><span class="fu">do.call</span>(grid.arrange, <span class="fu">c</span>(plots_comparacion, <span class="at">ncol =</span> <span class="dv">3</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="poisson_files/figure-html/comparacion-con-normal-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Comparación con distribución normal teórica</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="aplicaciones-de-la-distribución-de-poisson" class="level2">
<h2 class="anchored" data-anchor-id="aplicaciones-de-la-distribución-de-poisson">Aplicaciones de la Distribución de Poisson</h2>
<section id="gestión-de-tráfico-de-red" class="level3">
<h3 class="anchored" data-anchor-id="gestión-de-tráfico-de-red">Gestión de Tráfico de Red</h3>
<p><strong>Contexto:</strong> Una empresa de telecomunicaciones monitorea el tráfico de datos en sus servidores. El número de paquetes de datos que llegan por segundo sigue una distribución de Poisson.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parámetros del problema</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>lambda_trafico <span class="ot">&lt;-</span> <span class="fl">8.5</span>  <span class="co"># 8.5 paquetes por segundo en promedio</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"APLICACIÓN 1: TRÁFICO DE RED</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>APLICACIÓN 1: TRÁFICO DE RED</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"============================</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>============================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Parámetro: λ ="</span>, lambda_trafico, <span class="st">"paquetes por segundo</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parámetro: λ = 8.5 paquetes por segundo</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preguntas típicas</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"ANÁLISIS DEL TRÁFICO:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ANÁLISIS DEL TRÁFICO:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Probabilidad de recibir exactamente 10 paquetes en un segundo</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>prob_10 <span class="ot">&lt;-</span> <span class="fu">dpois</span>(<span class="dv">10</span>, lambda_trafico)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"1. P(X = 10 paquetes) ="</span>, <span class="fu">round</span>(prob_10, <span class="dv">4</span>), <span class="st">"("</span>, <span class="fu">round</span>(prob_10<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1. P(X = 10 paquetes) = 0.1104 ( 11.04 %)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Probabilidad de recibir más de 12 paquetes</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>prob_mas_12 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">ppois</span>(<span class="dv">12</span>, lambda_trafico)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"2. P(X &gt; 12 paquetes) ="</span>, <span class="fu">round</span>(prob_mas_12, <span class="dv">4</span>), <span class="st">"("</span>, <span class="fu">round</span>(prob_mas_12<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2. P(X &gt; 12 paquetes) = 0.0909 ( 9.09 %)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Número esperado de paquetes en 5 segundos</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="co"># En 5 segundos: Y ~ Poisson(5λ)</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>lambda_5seg <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">*</span> lambda_trafico</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>paquetes_5seg_esperados <span class="ot">&lt;-</span> lambda_5seg</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"3. Paquetes esperados en 5 segundos ="</span>, paquetes_5seg_esperados, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3. Paquetes esperados en 5 segundos = 42.5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Probabilidad de sobrecarga (más de 15 paquetes por segundo)</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>prob_sobrecarga <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">ppois</span>(<span class="dv">15</span>, lambda_trafico)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"4. P(Sobrecarga) = P(X &gt; 15) ="</span>, <span class="fu">round</span>(prob_sobrecarga, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4. P(Sobrecarga) = P(X &gt; 15) = 0.0138 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulación para verificar</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>n_sim_trafico <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>sim_paquetes <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n_sim_trafico, lambda_trafico)</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">VERIFICACIÓN POR SIMULACIÓN (n ="</span>, <span class="fu">format</span>(n_sim_trafico, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">"):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
VERIFICACIÓN POR SIMULACIÓN (n = 10,000 ):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Media simulada:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(sim_paquetes), <span class="dv">3</span>), <span class="st">"(teórica:"</span>, lambda_trafico, <span class="st">")</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Media simulada: 8.53 (teórica: 8.5 )</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P(X = 10) simulada:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(sim_paquetes <span class="sc">==</span> <span class="dv">10</span>), <span class="dv">4</span>), <span class="st">"(teórica:"</span>, <span class="fu">round</span>(prob_10, <span class="dv">4</span>), <span class="st">")</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P(X = 10) simulada: 0.1082 (teórica: 0.1104 )</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P(X &gt; 15) simulada:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(sim_paquetes <span class="sc">&gt;</span> <span class="dv">15</span>), <span class="dv">4</span>), <span class="st">"(teórica:"</span>, <span class="fu">round</span>(prob_sobrecarga, <span class="dv">4</span>), <span class="st">")</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P(X &gt; 15) simulada: 0.0153 (teórica: 0.0138 )</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualización del problema de tráfico</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>k_trafico <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>prob_trafico <span class="ot">&lt;-</span> <span class="fu">dpois</span>(k_trafico, lambda_trafico)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>data_trafico <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">paquetes =</span> k_trafico,</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">probabilidad =</span> prob_trafico</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir zonas</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>data_trafico<span class="sc">$</span>zona <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>  data_trafico<span class="sc">$</span>paquetes <span class="sc">&lt;=</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Bajo"</span>,</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>  data_trafico<span class="sc">$</span>paquetes <span class="sc">&lt;=</span> <span class="dv">12</span> <span class="sc">~</span> <span class="st">"Normal"</span>, </span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>  data_trafico<span class="sc">$</span>paquetes <span class="sc">&lt;=</span> <span class="dv">15</span> <span class="sc">~</span> <span class="st">"Alto"</span>,</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Sobrecarga"</span></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_trafico, <span class="fu">aes</span>(<span class="at">x =</span> paquetes, <span class="at">y =</span> probabilidad, <span class="at">fill =</span> zona)) <span class="sc">+</span></span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución del Tráfico de Red por Segundo"</span>,</span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"λ ="</span>, lambda_trafico, <span class="st">"paquetes/segundo"</span>),</span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Número de paquetes"</span>,</span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Probabilidad"</span>,</span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Zona de tráfico"</span>) <span class="sc">+</span></span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Bajo"</span> <span class="ot">=</span> <span class="st">"#2ECC71"</span>, <span class="st">"Normal"</span> <span class="ot">=</span> <span class="st">"#3498DB"</span>, </span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Alto"</span> <span class="ot">=</span> <span class="st">"#F39C12"</span>, <span class="st">"Sobrecarga"</span> <span class="ot">=</span> <span class="st">"#E74C3C"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="poisson_files/figure-html/grafico-trafico-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Distribución del tráfico de red y zonas críticas</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="control-de-calidad-industrial" class="level3">
<h3 class="anchored" data-anchor-id="control-de-calidad-industrial">Control de Calidad Industrial</h3>
<p><strong>Contexto:</strong> Una fábrica de semiconductores monitorea defectos en sus productos. El número de defectos por lote sigue una distribución de Poisson.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parámetros del control de calidad</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>lambda_defectos <span class="ot">&lt;-</span> <span class="fl">2.3</span>  <span class="co"># 2.3 defectos por lote en promedio</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"APLICACIÓN 2: CONTROL DE CALIDAD</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>APLICACIÓN 2: CONTROL DE CALIDAD</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"================================</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Parámetro: λ ="</span>, lambda_defectos, <span class="st">"defectos por lote</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parámetro: λ = 2.3 defectos por lote</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Análisis de calidad</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"ANÁLISIS DE CONTROL DE CALIDAD:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ANÁLISIS DE CONTROL DE CALIDAD:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Probabilidad de lote perfecto (0 defectos)</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>prob_perfecto <span class="ot">&lt;-</span> <span class="fu">dpois</span>(<span class="dv">0</span>, lambda_defectos)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"1. P(Lote perfecto) = P(X = 0) ="</span>, <span class="fu">round</span>(prob_perfecto, <span class="dv">4</span>), <span class="st">"("</span>, <span class="fu">round</span>(prob_perfecto<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1. P(Lote perfecto) = P(X = 0) = 0.1003 ( 10 %)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Probabilidad de lote aceptable (≤ 3 defectos)</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>prob_aceptable <span class="ot">&lt;-</span> <span class="fu">ppois</span>(<span class="dv">3</span>, lambda_defectos)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"2. P(Lote aceptable) = P(X ≤ 3) ="</span>, <span class="fu">round</span>(prob_aceptable, <span class="dv">4</span>), <span class="st">"("</span>, <span class="fu">round</span>(prob_aceptable<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2. P(Lote aceptable) = P(X ≤ 3) = 0.7993 ( 79.9 %)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Probabilidad de rechazo (&gt; 5 defectos)</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>prob_rechazo <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">ppois</span>(<span class="dv">5</span>, lambda_defectos)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"3. P(Rechazo) = P(X &gt; 5) ="</span>, <span class="fu">round</span>(prob_rechazo, <span class="dv">4</span>), <span class="st">"("</span>, <span class="fu">round</span>(prob_rechazo<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3. P(Rechazo) = P(X &gt; 5) = 0.03 ( 3 %)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Análisis económico</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>costo_defecto <span class="ot">&lt;-</span> <span class="dv">50</span>  <span class="co"># $50 por defecto</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>defectos_esperados <span class="ot">&lt;-</span> lambda_defectos</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>costo_esperado_lote <span class="ot">&lt;-</span> defectos_esperados <span class="sc">*</span> costo_defecto</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"4. Costo esperado por defectos por lote: $"</span>, costo_esperado_lote, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4. Costo esperado por defectos por lote: $ 115 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Análisis de múltiples lotes</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>n_lotes <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>lambda_total <span class="ot">&lt;-</span> n_lotes <span class="sc">*</span> lambda_defectos</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"5. Defectos esperados en"</span>, n_lotes, <span class="st">"lotes:"</span>, lambda_total, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>5. Defectos esperados en 100 lotes: 230 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulación del proceso de control de calidad</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>n_lotes_sim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>lotes_simulados <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n_lotes_sim, lambda_defectos)</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Clasificar lotes</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>clasificacion <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>  lotes_simulados <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"Perfecto"</span>,</span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>  lotes_simulados <span class="sc">&lt;=</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Aceptable"</span>,</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>  lotes_simulados <span class="sc">&lt;=</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Revisión"</span>,</span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Rechazo"</span></span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear data frame para visualización</span></span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a>data_calidad <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">defectos =</span> lotes_simulados,</span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">clasificacion =</span> <span class="fu">factor</span>(clasificacion, </span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Perfecto"</span>, <span class="st">"Aceptable"</span>, <span class="st">"Revisión"</span>, <span class="st">"Rechazo"</span>))</span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb127-20"><a href="#cb127-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-21"><a href="#cb127-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de la simulación</span></span>
<span id="cb127-22"><a href="#cb127-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_calidad, <span class="fu">aes</span>(<span class="at">x =</span> defectos, <span class="at">fill =</span> clasificacion)) <span class="sc">+</span></span>
<span id="cb127-23"><a href="#cb127-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">15</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb127-24"><a href="#cb127-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Simulación de Control de Calidad"</span>,</span>
<span id="cb127-25"><a href="#cb127-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"n ="</span>, <span class="fu">format</span>(n_lotes_sim, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">"lotes simulados"</span>),</span>
<span id="cb127-26"><a href="#cb127-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Número de defectos por lote"</span>,</span>
<span id="cb127-27"><a href="#cb127-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frecuencia"</span>,</span>
<span id="cb127-28"><a href="#cb127-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Clasificación"</span>) <span class="sc">+</span></span>
<span id="cb127-29"><a href="#cb127-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb127-30"><a href="#cb127-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Perfecto"</span> <span class="ot">=</span> <span class="st">"#2ECC71"</span>, <span class="st">"Aceptable"</span> <span class="ot">=</span> <span class="st">"#3498DB"</span>,</span>
<span id="cb127-31"><a href="#cb127-31" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Revisión"</span> <span class="ot">=</span> <span class="st">"#F39C12"</span>, <span class="st">"Rechazo"</span> <span class="ot">=</span> <span class="st">"#E74C3C"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="poisson_files/figure-html/simulacion-calidad-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Simulación del proceso de control de calidad</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla de resultados de la simulación</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>tabla_clasificacion <span class="ot">&lt;-</span> <span class="fu">table</span>(clasificacion)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>prop_clasificacion <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(tabla_clasificacion)</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RESULTADOS DE LA SIMULACIÓN:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
RESULTADOS DE LA SIMULACIÓN:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"============================</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>============================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(tabla_clasificacion)) {</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">names</span>(tabla_clasificacion)[i], <span class="st">":"</span>, tabla_clasificacion[i], </span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>      <span class="st">"lotes ("</span>, <span class="fu">round</span>(prop_clasificacion[i]<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Aceptable : 676 lotes ( 67.6 %)
Perfecto : 110 lotes ( 11 %)
Rechazo : 26 lotes ( 2.6 %)
Revisión : 188 lotes ( 18.8 %)</code></pre>
</div>
</div>
</section>
<section id="epidemiología-y-salud-pública" class="level3">
<h3 class="anchored" data-anchor-id="epidemiología-y-salud-pública">Epidemiología y Salud Pública</h3>
<p><strong>Contexto:</strong> Un epidemiólogo estudia la incidencia de una enfermedad rara en una población. Los nuevos casos por semana siguen una distribución de Poisson.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parámetros epidemiológicos</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>lambda_casos <span class="ot">&lt;-</span> <span class="fl">4.2</span>  <span class="co"># 4.2 casos nuevos por semana en promedio</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"APLICACIÓN 3: EPIDEMIOLOGÍA</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>APLICACIÓN 3: EPIDEMIOLOGÍA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"===========================</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>===========================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Parámetro: λ ="</span>, lambda_casos, <span class="st">"casos nuevos por semana</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parámetro: λ = 4.2 casos nuevos por semana</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"ANÁLISIS EPIDEMIOLÓGICO:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ANÁLISIS EPIDEMIOLÓGICO:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Probabilidad de semana sin casos nuevos</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>prob_sin_casos <span class="ot">&lt;-</span> <span class="fu">dpois</span>(<span class="dv">0</span>, lambda_casos)</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"1. P(Semana sin casos) ="</span>, <span class="fu">round</span>(prob_sin_casos, <span class="dv">4</span>), <span class="st">"("</span>, <span class="fu">round</span>(prob_sin_casos<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1. P(Semana sin casos) = 0.015 ( 1.5 %)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Probabilidad de brote (más de 8 casos)</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>prob_brote <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">ppois</span>(<span class="dv">8</span>, lambda_casos)</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"2. P(Brote) = P(X &gt; 8) ="</span>, <span class="fu">round</span>(prob_brote, <span class="dv">4</span>), <span class="st">"("</span>, <span class="fu">round</span>(prob_brote<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2. P(Brote) = P(X &gt; 8) = 0.0279 ( 2.8 %)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Casos esperados en un mes (4 semanas)</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>casos_mes <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">*</span> lambda_casos</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"3. Casos esperados en un mes:"</span>, casos_mes, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3. Casos esperados en un mes: 16.8 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Análisis de intervención</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Si una intervención reduce λ en 30%</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>lambda_intervencion <span class="ot">&lt;-</span> lambda_casos <span class="sc">*</span> <span class="fl">0.7</span></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>reduccion_casos_mes <span class="ot">&lt;-</span> (lambda_casos <span class="sc">-</span> lambda_intervencion) <span class="sc">*</span> <span class="dv">4</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"4. Con intervención (reducción 30%):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4. Con intervención (reducción 30%):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   Nuevos casos esperados por semana:"</span>, lambda_intervencion, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Nuevos casos esperados por semana: 2.94 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   Reducción esperada por mes:"</span>, reduccion_casos_mes, <span class="st">"casos</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Reducción esperada por mes: 5.04 casos</code></pre>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Monitoreo de alertas</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>umbral_alerta <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>prob_alerta <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">ppois</span>(umbral_alerta <span class="sc">-</span> <span class="dv">1</span>, lambda_casos)</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"5. P(Alerta) = P(X ≥"</span>, umbral_alerta, <span class="st">") ="</span>, <span class="fu">round</span>(prob_alerta, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>5. P(Alerta) = P(X ≥ 7 ) = 0.1325 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparación antes y después de intervención</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>k_epi <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">15</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>prob_antes <span class="ot">&lt;-</span> <span class="fu">dpois</span>(k_epi, lambda_casos)</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>prob_despues <span class="ot">&lt;-</span> <span class="fu">dpois</span>(k_epi, lambda_intervencion)</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>data_epi <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">casos =</span> <span class="fu">rep</span>(k_epi, <span class="dv">2</span>),</span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">probabilidad =</span> <span class="fu">c</span>(prob_antes, prob_despues),</span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">escenario =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Sin intervención"</span>, <span class="st">"Con intervención"</span>), <span class="at">each =</span> <span class="fu">length</span>(k_epi))</span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb156-11"><a href="#cb156-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-12"><a href="#cb156-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_epi, <span class="fu">aes</span>(<span class="at">x =</span> casos, <span class="at">y =</span> probabilidad, <span class="at">fill =</span> escenario)) <span class="sc">+</span></span>
<span id="cb156-13"><a href="#cb156-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb156-14"><a href="#cb156-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> umbral_alerta <span class="sc">-</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb156-15"><a href="#cb156-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Impacto de Intervención en Salud Pública"</span>,</span>
<span id="cb156-16"><a href="#cb156-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Reducción del 30% en la incidencia (λ:"</span>, lambda_casos, <span class="st">"→"</span>, lambda_intervencion, <span class="st">")"</span>),</span>
<span id="cb156-17"><a href="#cb156-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Número de casos nuevos por semana"</span>,</span>
<span id="cb156-18"><a href="#cb156-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Probabilidad"</span>,</span>
<span id="cb156-19"><a href="#cb156-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Escenario"</span>,</span>
<span id="cb156-20"><a href="#cb156-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Línea roja: umbral de alerta"</span>) <span class="sc">+</span></span>
<span id="cb156-21"><a href="#cb156-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb156-22"><a href="#cb156-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Sin intervención"</span> <span class="ot">=</span> <span class="st">"#E74C3C"</span>, <span class="st">"Con intervención"</span> <span class="ot">=</span> <span class="st">"#2ECC71"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="poisson_files/figure-html/visualizacion-epidemiologia-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Análisis epidemiológico con y sin intervención</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="ejercicios-propuestos" class="level2">
<h2 class="anchored" data-anchor-id="ejercicios-propuestos">Ejercicios Propuestos</h2>
<div id="exr-centro-atencion" class="theorem exercise">
<p><span class="theorem-title"><strong>Ejercicio 1</strong></span> Un centro de atención telefónica recibe llamadas siguiendo una distribución de Poisson con una tasa promedio de 6 llamadas por minuto.</p>
<p><strong>Preguntas:</strong></p>
<ol type="a">
<li><p>¿Cuál es la probabilidad de recibir exactamente 4 llamadas en un minuto?</p></li>
<li><p>¿Cuál es la probabilidad de no recibir ninguna llamada en 30 segundos?</p></li>
<li><p>¿Cuál es el número esperado de llamadas en una hora?</p></li>
<li><p>¿Cuál es la probabilidad de recibir entre 8 y 12 llamadas (inclusive) en dos minutos?</p></li>
</ol>
</div>
<div id="exr-linea_prod" class="theorem exercise">
<p><span class="theorem-title"><strong>Ejercicio 2</strong></span> Una línea de producción tiene en promedio 1.5 defectos por cada 100 productos fabricados.</p>
<p><strong>Preguntas:</strong></p>
<ol type="a">
<li><p>Si se fabrican 500 productos, ¿cuál es la probabilidad de tener exactamente 8 defectos?</p></li>
<li><p>¿Cuál es la probabilidad de tener 10 o más defectos en 500 productos?</p></li>
<li><p>¿Cuántos productos se deben fabricar para que la probabilidad de tener al menos un defecto sea de 0.95?</p></li>
<li><p>Si la empresa mejora el proceso y reduce los defectos a 1.2 por cada 100 productos, ¿cuál sería la nueva probabilidad de tener 10 o más defectos en 500 productos?</p></li>
</ol>
</div>
<div id="exr-hospital" class="theorem exercise">
<p><span class="theorem-title"><strong>Ejercicio 3</strong></span> El servicio de urgencias de un hospital recibe pacientes según un proceso de Poisson con una tasa promedio de 2.5 pacientes por hora durante la noche.</p>
<p><strong>Preguntas:</strong></p>
<ol type="a">
<li><p>¿Cuál es la probabilidad de que lleguen exactamente 3 pacientes en una hora?</p></li>
<li><p>¿Cuál es la probabilidad de que no llegue ningún paciente en 2 horas consecutivas?</p></li>
<li><p>El hospital tiene capacidad para atender 8 pacientes por turno de 4 horas. ¿Cuál es la probabilidad de superar esta capacidad?</p></li>
<li><p>¿Cuál debería ser la capacidad mínima para que la probabilidad de saturación sea menor al 10% en un turno de 4 horas?</p></li>
</ol>
</div>
<div id="exr-tcl_poisson" class="theorem exercise">
<p><span class="theorem-title"><strong>Ejercicio 4</strong></span> Implementa una verificación completa del Teorema Central del Límite para una distribución Poisson con <span class="math inline">\(\lambda = 7\)</span>.</p>
</div>
<div id="exr-prop_aditiva" class="theorem exercise">
<p><span class="theorem-title"><strong>Ejercicio 5</strong></span> Verifica por simulación que si <span class="math inline">\(X_1 \sim \text{Poisson}(3.5)\)</span> y <span class="math inline">\(X_2 \sim \text{Poisson}(2.8)\)</span> son independientes, entonces <span class="math inline">\(X_1 + X_2 \sim \text{Poisson}(6.3)\)</span>.</p>
<p><strong>Pasos específicos:</strong></p>
<ol type="a">
<li>Generar 10,000 muestras de cada distribución y calcule su suma</li>
<li>Comparar las estadísticas de la suma con una Poisson(6.3) directa</li>
<li>Extienda la verificación a la suma de 4 variables Poisson independientes</li>
</ol>
</div>
<div id="exr-aplicacion_web" class="theorem exercise">
<p><span class="theorem-title"><strong>Ejercicio 6</strong></span> Un sitio web recibe en promedio 15 visitantes por minuto durante las horas pico. El servidor puede manejar hasta 25 solicitudes simultáneas sin degradación del rendimiento.</p>
<p><strong>Análisis requerido:</strong></p>
<ol type="a">
<li><p>¿Cuál es la probabilidad de que en un minuto el servidor experimente degradación?</p></li>
<li><p>Si se duplica la capacidad del servidor (50 solicitudes), ¿cómo cambia la probabilidad de degradación?</p></li>
<li><p>¿Cuál sería la capacidad óptima del servidor para que la probabilidad de degradación sea menor al 1%?</p></li>
<li><p>Simule el comportamiento del servidor durante una hora (60 minutos) y calcule el porcentaje de tiempo con degradación.</p></li>
</ol>
</div>
<div id="exr-inventarios" class="theorem exercise">
<p><span class="theorem-title"><strong>Ejercicio 7</strong></span> Una tienda registra que el número de cierto producto vendido por día sigue una distribución Poisson con <span class="math inline">\(\lambda = 8\)</span>.</p>
<p><strong>Problemas de optimización:</strong></p>
<ol type="a">
<li><p>Si la tienda mantiene un inventario de 12 unidades al inicio del día, ¿cuál es la probabilidad de quedarse sin existencias?</p></li>
<li><p>¿Cuántas unidades debe tener para que la probabilidad de agotarse sea menor al 5%?</p></li>
<li><p>Calcule el costo esperado diario si:</p>
<ul>
<li>Cada unidad no vendida cuesta $2 mantenerla en inventario</li>
<li>Cada venta perdida por falta de stock cuesta $15</li>
<li>El costo de adquisición es $10 por unidad</li>
</ul></li>
<li><p>Determine el nivel óptimo de inventario que minimiza el costo total esperado.</p></li>
</ol>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>